  
  [1X3 [33X[0;0YExamples and tests[133X[101X
  
  
  [1X3.1 [33X[0;0YExamples[133X[101X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27XLoadPackage( "FreydCategoriesForCAP", false );[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XQ := HomalgFieldOfRationals();;[127X[104X
    [4X[25Xgap>[125X [27Xvec := MatrixCategoryAsCategoryOfRows( Q : no_precompiled_code := true );;[127X[104X
    [4X[25Xgap>[125X [27XV := MatrixCategoryObject( vec, 2 );;[127X[104X
    [4X[25Xgap>[125X [27Xalpha := ZeroMorphism( V, V );;[127X[104X
    [4X[25Xgap>[125X [27Xbeta := IdentityMorphism( V );;[127X[104X
    [4X[25Xgap>[125X [27XW := DirectSum( V, V );;[127X[104X
    [4X[25Xgap>[125X [27Xmorphism_matrix := [ [ alpha, beta ], [ beta, alpha ] ];;[127X[104X
    [4X[25Xgap>[125X [27X# compile the derivation of MorphismBetweenDirectSumsWithGivenDirectSums[127X[104X
    [4X[25X>[125X [27XPrint([127X[104X
    [4X[25X>[125X [27X    vec!.added_functions.MorphismBetweenDirectSumsWithGivenDirectSums[1][1],[127X[104X
    [4X[25X>[125X [27X    "\n"[127X[104X
    [4X[25X>[125X [27X);[127X[104X
    [4X[28Xfunction ( cat, S, diagram_S, morphism_matrix, diagram_T, T )[128X[104X
    [4X[28X    local test_diagram_product, test_diagram_coproduct;[128X[104X
    [4X[28X    test_diagram_coproduct := ListN( diagram_S, morphism_matrix, [128X[104X
    [4X[28X       function ( source, row )[128X[104X
    [4X[28X            return UniversalMorphismIntoDirectSumWithGivenDirectSum( cat, [128X[104X
    [4X[28X               diagram_T, source, row, T );[128X[104X
    [4X[28X        end );[128X[104X
    [4X[28X    return UniversalMorphismFromDirectSumWithGivenDirectSum( cat, diagram_S, [128X[104X
    [4X[28X       T, test_diagram_coproduct, S );[128X[104X
    [4X[28Xend[128X[104X
    [4X[25Xgap>[125X [27Xcompiled_func2 := CapJitCompiledFunction([127X[104X
    [4X[25X>[125X [27X    vec!.added_functions.MorphismBetweenDirectSumsWithGivenDirectSums[1][1],[127X[104X
    [4X[25X>[125X [27X    vec[127X[104X
    [4X[25X>[125X [27X);;[127X[104X
    [4X[25Xgap>[125X [27XDisplay( compiled_func2 );[127X[104X
    [4X[28Xfunction ( cat_1, S_1, diagram_S_1, morphism_matrix_1, diagram_T_1, T_1 )[128X[104X
    [4X[28X    local hoisted_1_1, deduped_2_1;[128X[104X
    [4X[28X    deduped_2_1 := UnderlyingRing( cat_1 );[128X[104X
    [4X[28X    hoisted_1_1 := deduped_2_1;[128X[104X
    [4X[28X    return CreateCapCategoryMorphismWithAttributes( cat_1, S_1, T_1, [128X[104X
    [4X[28X       UnderlyingMatrix, UnionOfRows( deduped_2_1, Dimension( T_1 ), [128X[104X
    [4X[28X         ListN( diagram_S_1, morphism_matrix_1, [128X[104X
    [4X[28X           function ( logic_new_func_x_2, logic_new_func_y_2 )[128X[104X
    [4X[28X                return [128X[104X
    [4X[28X                 UnionOfColumns( hoisted_1_1, Dimension( logic_new_func_x_2 )[128X[104X
    [4X[28X                    , List( logic_new_func_y_2, UnderlyingMatrix ) );[128X[104X
    [4X[28X            end ) ) );[128X[104X
    [4X[28Xend[128X[104X
    [4X[25Xgap>[125X [27XDisplay( ENHANCED_SYNTAX_TREE_CODE([127X[104X
    [4X[25X>[125X [27X    CapJitCompiledCAPOperationAsEnhancedSyntaxTree([127X[104X
    [4X[25X>[125X [27X        vec, "KernelEmbedding", true[127X[104X
    [4X[25X>[125X [27X    )[127X[104X
    [4X[25X>[125X [27X) );[127X[104X
    [4X[28Xfunction ( cat_1, alpha_1 )[128X[104X
    [4X[28X    local morphism_attr_1_1;[128X[104X
    [4X[28X    morphism_attr_1_1 := SyzygiesOfRows( UnderlyingMatrix( alpha_1 ) );[128X[104X
    [4X[28X    return CreateCapCategoryMorphismWithAttributes( cat_1, [128X[104X
    [4X[28X       CreateCapCategoryObjectWithAttributes( cat_1, Dimension, [128X[104X
    [4X[28X         NumberRows( morphism_attr_1_1 ) ), Source( alpha_1 ), [128X[104X
    [4X[28X       UnderlyingMatrix, morphism_attr_1_1 );[128X[104X
    [4X[28Xend[128X[104X
  [4X[32X[104X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27XLoadPackage( "FreydCategoriesForCAP", false );[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XLoadPackage( "LinearAlgebraForCAP", false );[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XReadPackage( "LinearAlgebraForCAP", "gap/CompilerLogic.gi" );[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XQQ := HomalgFieldOfRationals( );;[127X[104X
    [4X[25Xgap>[125X [27Xcategory_constructor := field -> MatrixCategoryAsCategoryOfRows( field );;[127X[104X
    [4X[25Xgap>[125X [27Xgiven_arguments := [ QQ ];;[127X[104X
    [4X[25Xgap>[125X [27Xcompiled_category_name := "MatrixCategoryPrecompiled";;[127X[104X
    [4X[25Xgap>[125X [27Xpackage_name := "LinearAlgebraForCAP";;[127X[104X
    [4X[25Xgap>[125X [27XCapJitPrecompileCategoryAndCompareResult([127X[104X
    [4X[25X>[125X [27X    category_constructor,[127X[104X
    [4X[25X>[125X [27X    given_arguments,[127X[104X
    [4X[25X>[125X [27X    package_name,[127X[104X
    [4X[25X>[125X [27X    compiled_category_name :[127X[104X
    [4X[25X>[125X [27X    number_of_objectified_objects_in_data_structure_of_object := 1,[127X[104X
    [4X[25X>[125X [27X    number_of_objectified_morphisms_in_data_structure_of_object := 0,[127X[104X
    [4X[25X>[125X [27X    number_of_objectified_objects_in_data_structure_of_morphism := 2,[127X[104X
    [4X[25X>[125X [27X    number_of_objectified_morphisms_in_data_structure_of_morphism := 1[127X[104X
    [4X[25X>[125X [27X);;[127X[104X
    [4X[25Xgap>[125X [27XMatrixCategoryPrecompiled( QQ );[127X[104X
    [4X[28XCategory of matrices over Q[128X[104X
    [4X[25Xgap>[125X [27X# check that the compiled code is loaded automatically[127X[104X
    [4X[25X>[125X [27X# for this, we use the name of the argument of `ZeroObject`:[127X[104X
    [4X[25X>[125X [27X# for non-compiled code it is "cat", while for compiled code it is "cat_1"[127X[104X
    [4X[25X>[125X [27Xcat := MatrixCategory( QQ );;[127X[104X
    [4X[25Xgap>[125X [27XNamesLocalVariablesFunction( Last( cat!.added_functions.ZeroObject )[1] )[1];[127X[104X
    [4X[28X"cat_1"[128X[104X
  [4X[32X[104X
  
  
  [1X3.2 [33X[0;0YTests[133X[101X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27XLoadPackage( "CompilerForCAP", false );[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27Xfunc := function ( )[127X[104X
    [4X[25X>[125X [27X  return List( [ 1, 2 ], x -> x ); end;;[127X[104X
    [4X[25Xgap>[125X [27Xtree := ENHANCED_SYNTAX_TREE( func );;[127X[104X
    [4X[25Xgap>[125X [27Xtree := CapJitAppliedLogic( tree );;[127X[104X
    [4X[25Xgap>[125X [27XDisplay( ENHANCED_SYNTAX_TREE_CODE( tree ) );[127X[104X
    [4X[28Xfunction (  )[128X[104X
    [4X[28X    return [ function ( x_2 )[128X[104X
    [4X[28X                return x_2;[128X[104X
    [4X[28X            end( 1 ), function ( x_2 )[128X[104X
    [4X[28X                return x_2;[128X[104X
    [4X[28X            end( 2 ) ];[128X[104X
    [4X[28Xend[128X[104X
    [4X[25Xgap>[125X [27Xfunc := function ( L1, L2 )[127X[104X
    [4X[25X>[125X [27X  return List( Concatenation( L1, L2 ), x -> x ); end;;[127X[104X
    [4X[25Xgap>[125X [27Xtree := ENHANCED_SYNTAX_TREE( func );;[127X[104X
    [4X[25Xgap>[125X [27Xtree := CapJitAppliedLogic( tree );;[127X[104X
    [4X[25Xgap>[125X [27XDisplay( ENHANCED_SYNTAX_TREE_CODE( tree ) );[127X[104X
    [4X[28Xfunction ( L1_1, L2_1 )[128X[104X
    [4X[28X    return Concatenation( List( L1_1, function ( x_2 )[128X[104X
    [4X[28X              return x_2;[128X[104X
    [4X[28X          end ), List( L2_1, function ( x_2 )[128X[104X
    [4X[28X              return x_2;[128X[104X
    [4X[28X          end ) );[128X[104X
    [4X[28Xend[128X[104X
    [4X[25Xgap>[125X [27Xfunc := function ( )[127X[104X
    [4X[25X>[125X [27X  return Concatenation( [ [ 1, 2, 3, 4 ] ] ); end;;[127X[104X
    [4X[25Xgap>[125X [27Xtree := ENHANCED_SYNTAX_TREE( func );;[127X[104X
    [4X[25Xgap>[125X [27Xtree := CapJitAppliedLogic( tree );;[127X[104X
    [4X[25Xgap>[125X [27XDisplay( ENHANCED_SYNTAX_TREE_CODE( tree ) );[127X[104X
    [4X[28Xfunction (  )[128X[104X
    [4X[28X    return [ 1, 2, 3, 4 ];[128X[104X
    [4X[28Xend[128X[104X
    [4X[25Xgap>[125X [27Xfunc := function ( )[127X[104X
    [4X[25X>[125X [27X  return Concatenation( [ [ 1, 2 ], [ 3, 4 ] ] ); end;;[127X[104X
    [4X[25Xgap>[125X [27Xtree := ENHANCED_SYNTAX_TREE( func );;[127X[104X
    [4X[25Xgap>[125X [27Xtree := CapJitAppliedLogic( tree );;[127X[104X
    [4X[25Xgap>[125X [27XDisplay( ENHANCED_SYNTAX_TREE_CODE( tree ) );[127X[104X
    [4X[28Xfunction (  )[128X[104X
    [4X[28X    return [ 1, 2, 3, 4 ];[128X[104X
    [4X[28Xend[128X[104X
    [4X[25Xgap>[125X [27Xfunc := function ( )[127X[104X
    [4X[25X>[125X [27X  return Concatenation( [ 1, 2 ], [ 3, 4 ] ); end;;[127X[104X
    [4X[25Xgap>[125X [27Xtree := ENHANCED_SYNTAX_TREE( func );;[127X[104X
    [4X[25Xgap>[125X [27Xtree := CapJitAppliedLogic( tree );;[127X[104X
    [4X[25Xgap>[125X [27XDisplay( ENHANCED_SYNTAX_TREE_CODE( tree ) );[127X[104X
    [4X[28Xfunction (  )[128X[104X
    [4X[28X    return [ 1, 2, 3, 4 ];[128X[104X
    [4X[28Xend[128X[104X
    [4X[25Xgap>[125X [27Xfunc := function ( my_func )[127X[104X
    [4X[25X>[125X [27X  return CallFuncList( my_func, [ 1, 2 ] ); end;;[127X[104X
    [4X[25Xgap>[125X [27Xtree := ENHANCED_SYNTAX_TREE( func );;[127X[104X
    [4X[25Xgap>[125X [27Xtree := CapJitAppliedLogic( tree );;[127X[104X
    [4X[25Xgap>[125X [27XDisplay( ENHANCED_SYNTAX_TREE_CODE( tree ) );[127X[104X
    [4X[28Xfunction ( my_func_1 )[128X[104X
    [4X[28X    return my_func_1( 1, 2 );[128X[104X
    [4X[28Xend[128X[104X
    [4X[25Xgap>[125X [27Xfunc := function ( x )[127X[104X
    [4X[25X>[125X [27X  if 1 = 2 then return 1; elif x = x then return 2; else return 3; fi; end;;[127X[104X
    [4X[25Xgap>[125X [27Xtree := ENHANCED_SYNTAX_TREE( func );;[127X[104X
    [4X[25Xgap>[125X [27Xtree := CapJitAppliedLogic( tree );;[127X[104X
    [4X[25Xgap>[125X [27XDisplay( ENHANCED_SYNTAX_TREE_CODE( tree ) );[127X[104X
    [4X[28Xfunction ( x_1 )[128X[104X
    [4X[28X    if false then[128X[104X
    [4X[28X        return 1;[128X[104X
    [4X[28X    elif true then[128X[104X
    [4X[28X        return 2;[128X[104X
    [4X[28X    else[128X[104X
    [4X[28X        return 3;[128X[104X
    [4X[28X    fi;[128X[104X
    [4X[28X    return;[128X[104X
    [4X[28Xend[128X[104X
    [4X[25Xgap>[125X [27Xfunc := function ( x )[127X[104X
    [4X[25X>[125X [27X  return Length( [ 1, 2, 3 ] ); end;;[127X[104X
    [4X[25Xgap>[125X [27Xtree := ENHANCED_SYNTAX_TREE( func );;[127X[104X
    [4X[25Xgap>[125X [27Xtree := CapJitAppliedLogic( tree );;[127X[104X
    [4X[25Xgap>[125X [27XDisplay( ENHANCED_SYNTAX_TREE_CODE( tree ) );[127X[104X
    [4X[28Xfunction ( x_1 )[128X[104X
    [4X[28X    return 3;[128X[104X
    [4X[28Xend[128X[104X
    [4X[25Xgap>[125X [27Xfunc := function ( x )[127X[104X
    [4X[25X>[125X [27X  return [ 1 .. 3 ]; end;;[127X[104X
    [4X[25Xgap>[125X [27Xtree := ENHANCED_SYNTAX_TREE( func );;[127X[104X
    [4X[25Xgap>[125X [27Xtree := CapJitAppliedLogic( tree );;[127X[104X
    [4X[25Xgap>[125X [27XDisplay( ENHANCED_SYNTAX_TREE_CODE( tree ) );[127X[104X
    [4X[28Xfunction ( x_1 )[128X[104X
    [4X[28X    return [ 1, 2, 3 ];[128X[104X
    [4X[28Xend[128X[104X
    [4X[25Xgap>[125X [27Xfunc := function ( x )[127X[104X
    [4X[25X>[125X [27X  return Last( [ 3, 2, 1 ] ); end;;[127X[104X
    [4X[25Xgap>[125X [27Xtree := ENHANCED_SYNTAX_TREE( func );;[127X[104X
    [4X[25Xgap>[125X [27Xtree := CapJitAppliedLogic( tree );;[127X[104X
    [4X[25Xgap>[125X [27XDisplay( ENHANCED_SYNTAX_TREE_CODE( tree ) );[127X[104X
    [4X[28Xfunction ( x_1 )[128X[104X
    [4X[28X    return 1;[128X[104X
    [4X[28Xend[128X[104X
    [4X[25Xgap>[125X [27Xfunc := function ( list_of_lists )[127X[104X
    [4X[25X>[125X [27X  return Length( Concatenation( list_of_lists ) ); end;;[127X[104X
    [4X[25Xgap>[125X [27Xtree := ENHANCED_SYNTAX_TREE( func );;[127X[104X
    [4X[25Xgap>[125X [27Xtree := CapJitAppliedLogic( tree );;[127X[104X
    [4X[25Xgap>[125X [27XDisplay( ENHANCED_SYNTAX_TREE_CODE( tree ) );[127X[104X
    [4X[28Xfunction ( list_of_lists_1 )[128X[104X
    [4X[28X    return Sum( List( list_of_lists_1, Length ) );[128X[104X
    [4X[28Xend[128X[104X
    [4X[25Xgap>[125X [27Xfunc := function ( list1, list2, list3 )[127X[104X
    [4X[25X>[125X [27X  return Length( Concatenation( list1, list2, list3 ) ); end;;[127X[104X
    [4X[25Xgap>[125X [27Xtree := ENHANCED_SYNTAX_TREE( func );;[127X[104X
    [4X[25Xgap>[125X [27Xtree := CapJitAppliedLogic( tree );;[127X[104X
    [4X[25Xgap>[125X [27XDisplay( ENHANCED_SYNTAX_TREE_CODE( tree ) );[127X[104X
    [4X[28Xfunction ( list1_1, list2_1, list3_1 )[128X[104X
    [4X[28X    return Sum( [ Length( list1_1 ), Length( list2_1 ), Length( list3_1 ) ] );[128X[104X
    [4X[28Xend[128X[104X
  [4X[32X[104X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27XLoadPackage( "CompilerForCAP", false );[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27X# example testing needed_packages[127X[104X
    [4X[25X>[125X [27Xtemplate := rec([127X[104X
    [4X[25X>[125X [27X    variable_names := [ "name" ],[127X[104X
    [4X[25X>[125X [27X    variable_filters := [ "THIS_SHOULD_NOT_BE_PARSED" ],[127X[104X
    [4X[25X>[125X [27X    src_template := "THIS_SHOULD_NOT_BE_PARSED_TOO",[127X[104X
    [4X[25X>[125X [27X    dst_template := "THIS_SHOULD_NOT_BE_PARSED_EITHER",[127X[104X
    [4X[25X>[125X [27X    needed_packages := [ [ "NON_EXISTING_PACKAGE", ">= 9999" ] ],[127X[104X
    [4X[25X>[125X [27X);;[127X[104X
    [4X[25Xgap>[125X [27XAdd( CAP_JIT_LOGIC_TEMPLATES, template );[127X[104X
    [4X[25Xgap>[125X [27XDisplay( CapJitCompiledFunction( x -> x ) );[127X[104X
    [4X[28Xfunction ( x_1 )[128X[104X
    [4X[28X    return x_1;[128X[104X
    [4X[28Xend[128X[104X
    [4X[25Xgap>[125X [27XIsIdenticalObj( Remove( CAP_JIT_LOGIC_TEMPLATES ), template );[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27Xapplied_logic_template_to_func :=[127X[104X
    [4X[25X>[125X [27X    { func, template, type_signature } ->[127X[104X
    [4X[25X>[125X [27X        ENHANCED_SYNTAX_TREE_CODE([127X[104X
    [4X[25X>[125X [27X            CAP_JIT_INTERNAL_APPLIED_LOGIC_TEMPLATES([127X[104X
    [4X[25X>[125X [27X                CapJitInferredDataTypes([127X[104X
    [4X[25X>[125X [27X                    ENHANCED_SYNTAX_TREE([127X[104X
    [4X[25X>[125X [27X                        func :[127X[104X
    [4X[25X>[125X [27X                        type_signature := type_signature[127X[104X
    [4X[25X>[125X [27X                    )[127X[104X
    [4X[25X>[125X [27X                ),[127X[104X
    [4X[25X>[125X [27X                [ template ][127X[104X
    [4X[25X>[125X [27X            )[127X[104X
    [4X[25X>[125X [27X        );;[127X[104X
    [4X[25Xgap>[125X [27X# some general example[127X[104X
    [4X[25X>[125X [27Xtemplate := rec([127X[104X
    [4X[25X>[125X [27X    variable_names := [ "variable" ],[127X[104X
    [4X[25X>[125X [27X    src_template := "x -> x + variable + x - x",[127X[104X
    [4X[25X>[125X [27X    dst_template := "x -> x + variable + 0",[127X[104X
    [4X[25X>[125X [27X);;[127X[104X
    [4X[25Xgap>[125X [27XCAP_JIT_INTERNAL_ENHANCE_LOGIC_TEMPLATE( template );[127X[104X
    [4X[25Xgap>[125X [27Xfunc := function ( a )[127X[104X
    [4X[25X>[125X [27X    return b -> b + ( 2 * b + a ) + b - b; end;;[127X[104X
    [4X[25Xgap>[125X [27XDisplay( applied_logic_template_to_func( func, template, fail ) );[127X[104X
    [4X[28Xfunction ( a_1 )[128X[104X
    [4X[28X    return function ( b_2 )[128X[104X
    [4X[28X          return b_2 + (2 * b_2 + a_1) + 0;[128X[104X
    [4X[28X      end;[128X[104X
    [4X[28Xend[128X[104X
    [4X[25Xgap>[125X [27X# example using EXPR_CASE[127X[104X
    [4X[25X>[125X [27Xtemplate := rec([127X[104X
    [4X[25X>[125X [27X    variable_names := [ "val1", "val2" ],[127X[104X
    [4X[25X>[125X [27X    src_template := "CAP_JIT_INTERNAL_EXPR_CASE( 1 <> 1, val1, true, val2 )",[127X[104X
    [4X[25X>[125X [27X    dst_template := "val2",[127X[104X
    [4X[25X>[125X [27X);;[127X[104X
    [4X[25Xgap>[125X [27XCAP_JIT_INTERNAL_ENHANCE_LOGIC_TEMPLATE( template );[127X[104X
    [4X[25Xgap>[125X [27Xfunc := function ( )[127X[104X
    [4X[25X>[125X [27X    if 1 <> 1 then return 1; else return 2; fi; end;;[127X[104X
    [4X[25Xgap>[125X [27XDisplay( applied_logic_template_to_func( func, template, fail ) );[127X[104X
    [4X[28Xfunction ( )[128X[104X
    [4X[28X    return 2;[128X[104X
    [4X[28Xend[128X[104X
    [4X[25Xgap>[125X [27X# check that functions in variables can match[127X[104X
    [4X[25X>[125X [27X# and test variable_filters (strings and filters)[127X[104X
    [4X[25X>[125X [27Xtemplate := rec([127X[104X
    [4X[25X>[125X [27X    variable_names := [ "L1", "L2", "func" ],[127X[104X
    [4X[25X>[125X [27X    variable_filters := [ "IsList", IsList, IsFunction ],[127X[104X
    [4X[25X>[125X [27X    src_template := "Concatenation( [ List( L1, func ), List( L2, func ) ] )",[127X[104X
    [4X[25X>[125X [27X    dst_template := "List( Concatenation( [ L1, L2 ] ), func )",[127X[104X
    [4X[25X>[125X [27X);;[127X[104X
    [4X[25Xgap>[125X [27XCAP_JIT_INTERNAL_ENHANCE_LOGIC_TEMPLATE( template );[127X[104X
    [4X[25Xgap>[125X [27Xfunc := { L1, L2 } ->[127X[104X
    [4X[25X>[125X [27X    Concatenation( [ List( L1, x -> x ), List( L2, x -> x ) ] );;[127X[104X
    [4X[25Xgap>[125X [27XDisplay( applied_logic_template_to_func([127X[104X
    [4X[25X>[125X [27X    func,[127X[104X
    [4X[25X>[125X [27X    template,[127X[104X
    [4X[25X>[125X [27X    [[127X[104X
    [4X[25X>[125X [27X        [[127X[104X
    [4X[25X>[125X [27X            rec( filter := IsList, element_type := rec( filter := IsInt ) ),[127X[104X
    [4X[25X>[125X [27X            rec( filter := IsList, element_type := rec( filter := IsInt ) ),[127X[104X
    [4X[25X>[125X [27X        ],[127X[104X
    [4X[25X>[125X [27X        fail,[127X[104X
    [4X[25X>[125X [27X    ][127X[104X
    [4X[25X>[125X [27X) );[127X[104X
    [4X[28Xfunction ( L1_1, L2_1 )[128X[104X
    [4X[28X    return List( Concatenation( [ L1_1, L2_1 ] ), function ( x_2 )[128X[104X
    [4X[28X            return x_2;[128X[104X
    [4X[28X        end );[128X[104X
    [4X[28Xend[128X[104X
    [4X[25Xgap>[125X [27X# check that template is not executed if data types cannot be determined[127X[104X
    [4X[25X>[125X [27XDisplay( applied_logic_template_to_func( func, template, fail ) );[127X[104X
    [4X[28Xfunction ( L1_1, L2_1 )[128X[104X
    [4X[28X    return Concatenation( [ List( L1_1, function ( x_2 )[128X[104X
    [4X[28X              return x_2;[128X[104X
    [4X[28X          end ), List( L2_1, function ( x_2 )[128X[104X
    [4X[28X              return x_2;[128X[104X
    [4X[28X          end ) ] );[128X[104X
    [4X[28Xend[128X[104X
    [4X[25Xgap>[125X [27X# check that template is only applied if filters match[127X[104X
    [4X[25X>[125X [27Xtemplate := rec([127X[104X
    [4X[25X>[125X [27X    variable_names := [ "value" ],[127X[104X
    [4X[25X>[125X [27X    variable_filters := [ IsInt ],[127X[104X
    [4X[25X>[125X [27X    src_template := "Sum( [ value ] )",[127X[104X
    [4X[25X>[125X [27X    dst_template := "value",[127X[104X
    [4X[25X>[125X [27X);;[127X[104X
    [4X[25Xgap>[125X [27XCAP_JIT_INTERNAL_ENHANCE_LOGIC_TEMPLATE( template );[127X[104X
    [4X[25Xgap>[125X [27Xfunc := { x } -> Sum( [ x ] );;[127X[104X
    [4X[25Xgap>[125X [27XDisplay( applied_logic_template_to_func([127X[104X
    [4X[25X>[125X [27X    func,[127X[104X
    [4X[25X>[125X [27X    template,[127X[104X
    [4X[25X>[125X [27X    [[127X[104X
    [4X[25X>[125X [27X        [[127X[104X
    [4X[25X>[125X [27X            rec( filter := IsInt ),[127X[104X
    [4X[25X>[125X [27X        ],[127X[104X
    [4X[25X>[125X [27X        fail,[127X[104X
    [4X[25X>[125X [27X    ][127X[104X
    [4X[25X>[125X [27X) );[127X[104X
    [4X[28Xfunction ( x_1 )[128X[104X
    [4X[28X    return x_1;[128X[104X
    [4X[28Xend[128X[104X
    [4X[25Xgap>[125X [27XDisplay( applied_logic_template_to_func([127X[104X
    [4X[25X>[125X [27X    func,[127X[104X
    [4X[25X>[125X [27X    template,[127X[104X
    [4X[25X>[125X [27X    [[127X[104X
    [4X[25X>[125X [27X        [[127X[104X
    [4X[25X>[125X [27X            rec( filter := IsFloat ),[127X[104X
    [4X[25X>[125X [27X        ],[127X[104X
    [4X[25X>[125X [27X        fail,[127X[104X
    [4X[25X>[125X [27X    ][127X[104X
    [4X[25X>[125X [27X) );[127X[104X
    [4X[28Xfunction ( x_1 )[128X[104X
    [4X[28X    return Sum( [ x_1 ] );[128X[104X
    [4X[28Xend[128X[104X
    [4X[25Xgap>[125X [27X# check that functions can be used multiple times in dst_template[127X[104X
    [4X[25X>[125X [27X# add a nonsense template[127X[104X
    [4X[25X>[125X [27Xtemplate := rec([127X[104X
    [4X[25X>[125X [27X    variable_names := [ "list", "value" ],[127X[104X
    [4X[25X>[125X [27X    src_template := "List( list, l -> value )",[127X[104X
    [4X[25X>[125X [27X    dst_template := "Sum( list, l -> value ) + Sum( list, l -> value )",[127X[104X
    [4X[25X>[125X [27X);;[127X[104X
    [4X[25Xgap>[125X [27XCAP_JIT_INTERNAL_ENHANCE_LOGIC_TEMPLATE( template );[127X[104X
    [4X[25Xgap>[125X [27Xfunc := function ( list )[127X[104X
    [4X[25X>[125X [27X    return List( list, x -> x ); end;;[127X[104X
    [4X[25Xgap>[125X [27XDisplay( applied_logic_template_to_func( func, template, fail ) );[127X[104X
    [4X[28Xfunction ( list_1 )[128X[104X
    [4X[28X    return Sum( list_1, function ( x_2 )[128X[104X
    [4X[28X              return x_2;[128X[104X
    [4X[28X          end ) + Sum( list_1, function ( x_2 )[128X[104X
    [4X[28X              return x_2;[128X[104X
    [4X[28X          end );[128X[104X
    [4X[28Xend[128X[104X
    [4X[25Xgap>[125X [27Xfunc := function ( list )[127X[104X
    [4X[25X>[125X [27X    return List( list, x -> (y -> y) ); end;;[127X[104X
    [4X[25Xgap>[125X [27XDisplay( applied_logic_template_to_func( func, template, fail ) );[127X[104X
    [4X[28Xfunction ( list_1 )[128X[104X
    [4X[28X    return Sum( list_1, function ( x_2 )[128X[104X
    [4X[28X              return function ( y_3 )[128X[104X
    [4X[28X                    return y_3;[128X[104X
    [4X[28X                end;[128X[104X
    [4X[28X          end ) + Sum( list_1, function ( x_2 )[128X[104X
    [4X[28X              return function ( y_3 )[128X[104X
    [4X[28X                    return y_3;[128X[104X
    [4X[28X                end;[128X[104X
    [4X[28X          end );[128X[104X
    [4X[28Xend[128X[104X
    [4X[25Xgap>[125X [27X# check that functions with assignments to local variables do not match[127X[104X
    [4X[25X>[125X [27X# logic templates without assignments to local variables[127X[104X
    [4X[25X>[125X [27Xtemplate := rec([127X[104X
    [4X[25X>[125X [27X    variable_names := [ "value" ],[127X[104X
    [4X[25X>[125X [27X    src_template := "List( [ 1 ], l -> value )",[127X[104X
    [4X[25X>[125X [27X    dst_template := "(l -> value)(1)",[127X[104X
    [4X[25X>[125X [27X);;[127X[104X
    [4X[25Xgap>[125X [27XCAP_JIT_INTERNAL_ENHANCE_LOGIC_TEMPLATE( template );[127X[104X
    [4X[25Xgap>[125X [27Xfunc := function ( x )[127X[104X
    [4X[25X>[125X [27X    return List( [ 1 ], function ( y )[127X[104X
    [4X[25X>[125X [27X        local r; r := x; return r; end ); end;;[127X[104X
    [4X[25Xgap>[125X [27XDisplay( applied_logic_template_to_func( func, template, fail ) );[127X[104X
    [4X[28Xfunction ( x_1 )[128X[104X
    [4X[28X    return List( [ 1 ], function ( y_2 )[128X[104X
    [4X[28X            local r_2;[128X[104X
    [4X[28X            r_2 := x_1;[128X[104X
    [4X[28X            return r_2;[128X[104X
    [4X[28X        end );[128X[104X
    [4X[28Xend[128X[104X
    [4X[25Xgap>[125X [27X# check that values are pulled out iff[127X[104X
    [4X[25X>[125X [27X# they are independent of local variables[127X[104X
    [4X[25X>[125X [27Xtemplate := rec([127X[104X
    [4X[25X>[125X [27X    variable_names := [ "list", "value" ],[127X[104X
    [4X[25X>[125X [27X    src_template := "List( list, l -> value * l )",[127X[104X
    [4X[25X>[125X [27X    dst_template := "value * List( list, l -> l )",[127X[104X
    [4X[25X>[125X [27X);;[127X[104X
    [4X[25Xgap>[125X [27XCAP_JIT_INTERNAL_ENHANCE_LOGIC_TEMPLATE( template );[127X[104X
    [4X[25Xgap>[125X [27Xfunc := L -> List( L, l -> l * l );;[127X[104X
    [4X[25Xgap>[125X [27XDisplay( applied_logic_template_to_func( func, template, fail ) );[127X[104X
    [4X[28Xfunction ( L_1 )[128X[104X
    [4X[28X    return List( L_1, function ( l_2 )[128X[104X
    [4X[28X            return l_2 * l_2;[128X[104X
    [4X[28X        end );[128X[104X
    [4X[28Xend[128X[104X
    [4X[25Xgap>[125X [27Xfunc := L -> List( L, l -> 2 * l );;[127X[104X
    [4X[25Xgap>[125X [27XDisplay( applied_logic_template_to_func( func, template, fail ) );[127X[104X
    [4X[28Xfunction ( L_1 )[128X[104X
    [4X[28X    return 2 * List( L_1, function ( l_2 )[128X[104X
    [4X[28X              return l_2;[128X[104X
    [4X[28X          end );[128X[104X
    [4X[28Xend[128X[104X
  [4X[32X[104X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27XLoadPackage( "CompilerForCAP", false );[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27Xfunc := x -> MatElm( x, 1, 1 );;[127X[104X
    [4X[25Xgap>[125X [27Xtree := ENHANCED_SYNTAX_TREE( func );;[127X[104X
    [4X[25Xgap>[125X [27Xtree := CapJitResolvedGlobalVariables( tree );;[127X[104X
    [4X[25Xgap>[125X [27XDisplay( ENHANCED_SYNTAX_TREE_CODE( tree ) );[127X[104X
    [4X[28Xfunction ( x_1 )[128X[104X
    [4X[28X    return \[\,\]( x_1, 1, 1 );[128X[104X
    [4X[28Xend[128X[104X
  [4X[32X[104X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27XLoadPackage( "FreydCategoriesForCAP", false );[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XQQ := HomalgFieldOfRationalsInSingular( );;[127X[104X
    [4X[25Xgap>[125X [27XQQxy := QQ * "x,y";;[127X[104X
    [4X[25Xgap>[125X [27XEQQxy := KoszulDualRing( QQxy );;[127X[104X
    [4X[25Xgap>[125X [27XR := KoszulDualRing( HomalgRingOfIntegersInSingular( ) * "x,y" );;[127X[104X
    [4X[25Xgap>[125X [27Xprecompile_CategoryOfColumns := function( homalg_ring, name )[127X[104X
    [4X[25X>[125X [27X    [127X[104X
    [4X[25X>[125X [27X    CapJitPrecompileCategoryAndCompareResult([127X[104X
    [4X[25X>[125X [27X        homalg_ring -> CategoryOfColumnsAsOppositeOfCategoryOfRows([127X[104X
    [4X[25X>[125X [27X            homalg_ring[127X[104X
    [4X[25X>[125X [27X        ),[127X[104X
    [4X[25X>[125X [27X        [ homalg_ring ],[127X[104X
    [4X[25X>[125X [27X        "FreydCategoriesForCAP",[127X[104X
    [4X[25X>[125X [27X        Concatenation([127X[104X
    [4X[25X>[125X [27X            "CategoryOfColumnsAsOppositeOfCategoryOfRowsOf",[127X[104X
    [4X[25X>[125X [27X            name,[127X[104X
    [4X[25X>[125X [27X            "Precompiled"[127X[104X
    [4X[25X>[125X [27X        ) :[127X[104X
    [4X[25X>[125X [27X        operations := "primitive",[127X[104X
    [4X[25X>[125X [27X        number_of_objectified_objects_in_data_structure_of_object := 1,[127X[104X
    [4X[25X>[125X [27X        number_of_objectified_morphisms_in_data_structure_of_object := 0,[127X[104X
    [4X[25X>[125X [27X        number_of_objectified_objects_in_data_structure_of_morphism := 2,[127X[104X
    [4X[25X>[125X [27X        number_of_objectified_morphisms_in_data_structure_of_morphism := 1[127X[104X
    [4X[25X>[125X [27X    ); end;;[127X[104X
    [4X[25Xgap>[125X [27Xprecompile_CategoryOfColumns( QQ, "Field" );;[127X[104X
    [4X[25Xgap>[125X [27Xprecompile_CategoryOfColumns( QQxy, "CommutativeRing" );;[127X[104X
    [4X[25Xgap>[125X [27Xprecompile_CategoryOfColumns( EQQxy, "HomalgExteriorRingOverField" );;[127X[104X
    [4X[25Xgap>[125X [27Xprecompile_CategoryOfColumns( R, "ArbitraryRing" );;[127X[104X
  [4X[32X[104X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27XLoadPackage( "FreydCategoriesForCAP", false );[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XReadPackage( "FreydCategoriesForCAP",[127X[104X
    [4X[25X>[125X [27X    "gap/CategoryOfRowsAsAdditiveClosureOfRingAsCategory_CompilerLogic.gi");[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XQQ := HomalgFieldOfRationalsInSingular( );;[127X[104X
    [4X[25Xgap>[125X [27XQQxy := QQ * "x,y";;[127X[104X
    [4X[25Xgap>[125X [27XEQQxy := KoszulDualRing( QQxy );;[127X[104X
    [4X[25Xgap>[125X [27XR := KoszulDualRing( HomalgRingOfIntegersInSingular( ) * "x,y" );;[127X[104X
    [4X[25Xgap>[125X [27Xhom_structure_operations := [[127X[104X
    [4X[25X>[125X [27X    "DistinguishedObjectOfHomomorphismStructure",[127X[104X
    [4X[25X>[125X [27X    "HomomorphismStructureOnObjects",[127X[104X
    [4X[25X>[125X [27X    "HomomorphismStructureOnMorphismsWithGivenObjects",[127X[104X
    [4X[25X>[125X [27X    Concatenation([127X[104X
    [4X[25X>[125X [27X        "InterpretMorphismAsMorphismFromDistinguishedObject",[127X[104X
    [4X[25X>[125X [27X        "ToHomomorphismStructureWithGivenObjects"[127X[104X
    [4X[25X>[125X [27X    ),[127X[104X
    [4X[25X>[125X [27X    Concatenation([127X[104X
    [4X[25X>[125X [27X        "InterpretMorphismFromDistinguishedObject",[127X[104X
    [4X[25X>[125X [27X        "ToHomomorphismStructureAsMorphism"[127X[104X
    [4X[25X>[125X [27X    ),[127X[104X
    [4X[25X>[125X [27X];;[127X[104X
    [4X[25Xgap>[125X [27Xprecompile_CategoryOfRows := function( homalg_ring, name, operations )[127X[104X
    [4X[25X>[125X [27X    [127X[104X
    [4X[25X>[125X [27X    CapJitPrecompileCategoryAndCompareResult([127X[104X
    [4X[25X>[125X [27X        homalg_ring -> CategoryOfRowsAsAdditiveClosureOfRingAsCategory([127X[104X
    [4X[25X>[125X [27X            homalg_ring[127X[104X
    [4X[25X>[125X [27X        ),[127X[104X
    [4X[25X>[125X [27X        [ homalg_ring ],[127X[104X
    [4X[25X>[125X [27X        "FreydCategoriesForCAP",[127X[104X
    [4X[25X>[125X [27X        Concatenation([127X[104X
    [4X[25X>[125X [27X            "CategoryOfRowsAsAdditiveClosureOfRingAsCategoryOf",[127X[104X
    [4X[25X>[125X [27X            name,[127X[104X
    [4X[25X>[125X [27X            "Precompiled"[127X[104X
    [4X[25X>[125X [27X        ) :[127X[104X
    [4X[25X>[125X [27X        operations := operations,[127X[104X
    [4X[25X>[125X [27X        number_of_objectified_objects_in_data_structure_of_object := 1,[127X[104X
    [4X[25X>[125X [27X        number_of_objectified_morphisms_in_data_structure_of_object := 0,[127X[104X
    [4X[25X>[125X [27X        number_of_objectified_objects_in_data_structure_of_morphism := 2,[127X[104X
    [4X[25X>[125X [27X        number_of_objectified_morphisms_in_data_structure_of_morphism := 1[127X[104X
    [4X[25X>[125X [27X    ); end;;[127X[104X
    [4X[25Xgap>[125X [27Xprecompile_CategoryOfRows([127X[104X
    [4X[25X>[125X [27X    QQ, "Field", hom_structure_operations[127X[104X
    [4X[25X>[125X [27X);;[127X[104X
    [4X[25Xgap>[125X [27Xprecompile_CategoryOfRows([127X[104X
    [4X[25X>[125X [27X    QQxy, "CommutativeRing", hom_structure_operations[127X[104X
    [4X[25X>[125X [27X);;[127X[104X
    [4X[25Xgap>[125X [27Xprecompile_CategoryOfRows([127X[104X
    [4X[25X>[125X [27X    EQQxy, "HomalgExteriorRingOverField", hom_structure_operations[127X[104X
    [4X[25X>[125X [27X);;[127X[104X
    [4X[25Xgap>[125X [27Xprecompile_CategoryOfRows([127X[104X
    [4X[25X>[125X [27X    R, "ArbitraryRing", [ ][127X[104X
    [4X[25X>[125X [27X);;[127X[104X
  [4X[32X[104X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27XLoadPackage( "FreydCategoriesForCAP", false );[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27Xdummy := DummyCategory( rec([127X[104X
    [4X[25X>[125X [27X    list_of_operations_to_install := [[127X[104X
    [4X[25X>[125X [27X        # general category[127X[104X
    [4X[25X>[125X [27X        "PreCompose",[127X[104X
    [4X[25X>[125X [27X        "IdentityMorphism",[127X[104X
    [4X[25X>[125X [27X        "IsEqualForMorphisms",[127X[104X
    [4X[25X>[125X [27X        "IsEqualForMorphismsOnMor",[127X[104X
    [4X[25X>[125X [27X        "IsWellDefinedForMorphisms",[127X[104X
    [4X[25X>[125X [27X        [127X[104X
    [4X[25X>[125X [27X        # computable[127X[104X
    [4X[25X>[125X [27X        "IsCongruentForMorphisms",[127X[104X
    [4X[25X>[125X [27X        [127X[104X
    [4X[25X>[125X [27X        # pre-additive[127X[104X
    [4X[25X>[125X [27X        "AdditionForMorphisms",[127X[104X
    [4X[25X>[125X [27X        "SubtractionForMorphisms",[127X[104X
    [4X[25X>[125X [27X        "AdditiveInverseForMorphisms",[127X[104X
    [4X[25X>[125X [27X        "ZeroMorphism",[127X[104X
    [4X[25X>[125X [27X        [127X[104X
    [4X[25X>[125X [27X        # with zero object[127X[104X
    [4X[25X>[125X [27X        "ZeroObject",[127X[104X
    [4X[25X>[125X [27X        "UniversalMorphismIntoZeroObject",[127X[104X
    [4X[25X>[125X [27X        "UniversalMorphismFromZeroObject",[127X[104X
    [4X[25X>[125X [27X        "ZeroObjectFunctorial",[127X[104X
    [4X[25X>[125X [27X        [127X[104X
    [4X[25X>[125X [27X        # additive[127X[104X
    [4X[25X>[125X [27X        "DirectSum",[127X[104X
    [4X[25X>[125X [27X        "DirectSumFunctorial",[127X[104X
    [4X[25X>[125X [27X        "ProjectionInFactorOfDirectSum",[127X[104X
    [4X[25X>[125X [27X        "UniversalMorphismIntoDirectSum",[127X[104X
    [4X[25X>[125X [27X        "InjectionOfCofactorOfDirectSum",[127X[104X
    [4X[25X>[125X [27X        "UniversalMorphismFromDirectSum",[127X[104X
    [4X[25X>[125X [27X        [127X[104X
    [4X[25X>[125X [27X        # colifts[127X[104X
    [4X[25X>[125X [27X        "IsColiftable"[127X[104X
    [4X[25X>[125X [27X    ],[127X[104X
    [4X[25X>[125X [27X    properties := [[127X[104X
    [4X[25X>[125X [27X        "IsAdditiveCategory",[127X[104X
    [4X[25X>[125X [27X    ],[127X[104X
    [4X[25X>[125X [27X) );;[127X[104X
    [4X[25Xgap>[125X [27XStopCompilationAtPrimitivelyInstalledOperationsOfCategory( dummy );[127X[104X
    [4X[25Xgap>[125X [27XCapJitPrecompileCategoryAndCompareResult([127X[104X
    [4X[25X>[125X [27X    underlying_category -> CoFreydCategoryAsOppositeOfFreydCategoryOfOpposite([127X[104X
    [4X[25X>[125X [27X        underlying_category[127X[104X
    [4X[25X>[125X [27X    ),[127X[104X
    [4X[25X>[125X [27X    [ dummy ],[127X[104X
    [4X[25X>[125X [27X    "FreydCategoriesForCAP",[127X[104X
    [4X[25X>[125X [27X    "CoFreydCategoryAsOppositeOfFreydCategoryOfOppositePrecompiled" :[127X[104X
    [4X[25X>[125X [27X    operations := "primitive",[127X[104X
    [4X[25X>[125X [27X    number_of_objectified_objects_in_data_structure_of_object := 1,[127X[104X
    [4X[25X>[125X [27X    number_of_objectified_morphisms_in_data_structure_of_object := 0,[127X[104X
    [4X[25X>[125X [27X    number_of_objectified_objects_in_data_structure_of_morphism := 2,[127X[104X
    [4X[25X>[125X [27X    number_of_objectified_morphisms_in_data_structure_of_morphism := 1[127X[104X
    [4X[25X>[125X [27X);[127X[104X
  [4X[32X[104X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27XLoadPackage( "ModulePresentationsForCAP", false );[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XReadPackage( "LinearAlgebraForCAP", "gap/CompilerLogic.gi" );[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XQQ := HomalgFieldOfRationalsInSingular( );;[127X[104X
    [4X[25Xgap>[125X [27XQQxy := QQ * "x,y";;[127X[104X
    [4X[25Xgap>[125X [27XEEE := KoszulDualRing( QQxy * "a,b" );;[127X[104X
    [4X[25Xgap>[125X [27X# CAUTION: when adding new operations make sure that they are compatible[127X[104X
    [4X[25X>[125X [27X# with the ones added manually in `ADD_FUNCTIONS_FOR_LEFT/RIGHT_PRESENTATION`.[127X[104X
    [4X[25X>[125X [27Xoperations_for_arbitrary_ring := [[127X[104X
    [4X[25X>[125X [27X    "AdditionForMorphisms",[127X[104X
    [4X[25X>[125X [27X    "AdditiveInverseForMorphisms",[127X[104X
    [4X[25X>[125X [27X    #"AssociatorLeftToRightWithGivenTensorProducts",[127X[104X
    [4X[25X>[125X [27X    #"AssociatorRightToLeftWithGivenTensorProducts",[127X[104X
    [4X[25X>[125X [27X    #"BraidingWithGivenTensorProducts",[127X[104X
    [4X[25X>[125X [27X    #"CoevaluationMorphismWithGivenRange",[127X[104X
    [4X[25X>[125X [27X    "CokernelColiftWithGivenCokernelObject",[127X[104X
    [4X[25X>[125X [27X    "CokernelProjection",[127X[104X
    [4X[25X>[125X [27X    #"Colift",[127X[104X
    [4X[25X>[125X [27X    #"ColiftOrFail",[127X[104X
    [4X[25X>[125X [27X    "DirectSum",[127X[104X
    [4X[25X>[125X [27X    "EpimorphismFromSomeProjectiveObject",[127X[104X
    [4X[25X>[125X [27X    #"EvaluationMorphismWithGivenSource",[127X[104X
    [4X[25X>[125X [27X    "IdentityMorphism",[127X[104X
    [4X[25X>[125X [27X    "InjectionOfCofactorOfDirectSumWithGivenDirectSum",[127X[104X
    [4X[25X>[125X [27X    #"InternalHomOnMorphismsWithGivenInternalHoms",[127X[104X
    [4X[25X>[125X [27X    #"InternalHomOnObjects",[127X[104X
    [4X[25X>[125X [27X    #"IsColiftable",[127X[104X
    [4X[25X>[125X [27X    "IsCongruentForMorphisms",[127X[104X
    [4X[25X>[125X [27X    "IsEqualForMorphisms",[127X[104X
    [4X[25X>[125X [27X    #"IsEqualForObjects",[127X[104X
    [4X[25X>[125X [27X    #"IsLiftable",[127X[104X
    [4X[25X>[125X [27X    #"IsWellDefinedForMorphisms",[127X[104X
    [4X[25X>[125X [27X    #"IsWellDefinedForObjects",[127X[104X
    [4X[25X>[125X [27X    "IsZeroForMorphisms",[127X[104X
    [4X[25X>[125X [27X    #"KernelEmbedding",[127X[104X
    [4X[25X>[125X [27X    #"LeftUnitorWithGivenTensorProduct",[127X[104X
    [4X[25X>[125X [27X    #"Lift",[127X[104X
    [4X[25X>[125X [27X    #"LiftAlongMonomorphism",[127X[104X
    [4X[25X>[125X [27X    #"LiftOrFail",[127X[104X
    [4X[25X>[125X [27X    #"MultiplyWithElementOfCommutativeRingForMorphisms",[127X[104X
    [4X[25X>[125X [27X    #"PreCompose",[127X[104X
    [4X[25X>[125X [27X    "ProjectionInFactorOfDirectSumWithGivenDirectSum",[127X[104X
    [4X[25X>[125X [27X    #"RightUnitorWithGivenTensorProduct",[127X[104X
    [4X[25X>[125X [27X    #"TensorProductOnMorphismsWithGivenTensorProducts",[127X[104X
    [4X[25X>[125X [27X    #"TensorProductOnObjects",[127X[104X
    [4X[25X>[125X [27X    #"TensorUnit",[127X[104X
    [4X[25X>[125X [27X    "UniversalMorphismFromDirectSumWithGivenDirectSum",[127X[104X
    [4X[25X>[125X [27X    "UniversalMorphismFromZeroObjectWithGivenZeroObject",[127X[104X
    [4X[25X>[125X [27X    "UniversalMorphismIntoDirectSumWithGivenDirectSum",[127X[104X
    [4X[25X>[125X [27X    "UniversalMorphismIntoZeroObjectWithGivenZeroObject",[127X[104X
    [4X[25X>[125X [27X    "ZeroMorphism",[127X[104X
    [4X[25X>[125X [27X    "ZeroObject" [127X[104X
    [4X[25X>[125X [27X];;[127X[104X
    [4X[25Xgap>[125X [27Xoperations_for_commutative_ring := Concatenation([127X[104X
    [4X[25X>[125X [27X    operations_for_arbitrary_ring,[127X[104X
    [4X[25X>[125X [27X    [ "MultiplyWithElementOfCommutativeRingForMorphisms" ][127X[104X
    [4X[25X>[125X [27X);;[127X[104X
    [4X[25Xgap>[125X [27Xprecompile_LeftPresentations := function( ring, name, operations )[127X[104X
    [4X[25X>[125X [27X    [127X[104X
    [4X[25X>[125X [27X    CapJitPrecompileCategoryAndCompareResult([127X[104X
    [4X[25X>[125X [27X        ring -> LeftPresentationsAsFreydCategoryOfCategoryOfRows( ring ),[127X[104X
    [4X[25X>[125X [27X        [ ring ],[127X[104X
    [4X[25X>[125X [27X        "ModulePresentationsForCAP",[127X[104X
    [4X[25X>[125X [27X        Concatenation([127X[104X
    [4X[25X>[125X [27X            "LeftPresentationsAsFreydCategoryOfCategoryOfRowsOf",[127X[104X
    [4X[25X>[125X [27X            name,[127X[104X
    [4X[25X>[125X [27X            "Precompiled"[127X[104X
    [4X[25X>[125X [27X        ) :[127X[104X
    [4X[25X>[125X [27X        operations := operations[127X[104X
    [4X[25X>[125X [27X    ); end;;[127X[104X
    [4X[25Xgap>[125X [27Xprecompile_LeftPresentations([127X[104X
    [4X[25X>[125X [27X    QQ, "Field", operations_for_commutative_ring[127X[104X
    [4X[25X>[125X [27X);;[127X[104X
    [4X[25Xgap>[125X [27Xprecompile_LeftPresentations([127X[104X
    [4X[25X>[125X [27X    QQxy, "CommutativeRing", operations_for_commutative_ring[127X[104X
    [4X[25X>[125X [27X);;[127X[104X
    [4X[25Xgap>[125X [27Xprecompile_LeftPresentations([127X[104X
    [4X[25X>[125X [27X    EEE, "ArbitraryRing", operations_for_arbitrary_ring[127X[104X
    [4X[25X>[125X [27X);;[127X[104X
    [4X[25Xgap>[125X [27Xprecompile_RightPresentations := function( ring, name, operations )[127X[104X
    [4X[25X>[125X [27X    [127X[104X
    [4X[25X>[125X [27X    CapJitPrecompileCategoryAndCompareResult([127X[104X
    [4X[25X>[125X [27X        ring -> RightPresentationsAsFreydCategoryOfCategoryOfColumns( ring ),[127X[104X
    [4X[25X>[125X [27X        [ ring ],[127X[104X
    [4X[25X>[125X [27X        "ModulePresentationsForCAP",[127X[104X
    [4X[25X>[125X [27X        Concatenation([127X[104X
    [4X[25X>[125X [27X            "RightPresentationsAsFreydCategoryOfCategoryOfColumnsOf",[127X[104X
    [4X[25X>[125X [27X            name,[127X[104X
    [4X[25X>[125X [27X            "Precompiled"[127X[104X
    [4X[25X>[125X [27X        ) :[127X[104X
    [4X[25X>[125X [27X        operations := operations,[127X[104X
    [4X[25X>[125X [27X        number_of_objectified_objects_in_data_structure_of_object := 1,[127X[104X
    [4X[25X>[125X [27X        number_of_objectified_morphisms_in_data_structure_of_object := 0,[127X[104X
    [4X[25X>[125X [27X        number_of_objectified_objects_in_data_structure_of_morphism := 2,[127X[104X
    [4X[25X>[125X [27X        number_of_objectified_morphisms_in_data_structure_of_morphism := 1[127X[104X
    [4X[25X>[125X [27X    ); end;;[127X[104X
    [4X[25Xgap>[125X [27Xprecompile_RightPresentations([127X[104X
    [4X[25X>[125X [27X    QQ, "Field", operations_for_commutative_ring[127X[104X
    [4X[25X>[125X [27X);;[127X[104X
    [4X[25Xgap>[125X [27Xprecompile_RightPresentations([127X[104X
    [4X[25X>[125X [27X    QQxy, "CommutativeRing", operations_for_commutative_ring[127X[104X
    [4X[25X>[125X [27X);;[127X[104X
    [4X[25Xgap>[125X [27Xprecompile_RightPresentations([127X[104X
    [4X[25X>[125X [27X    EEE, "ArbitraryRing", operations_for_arbitrary_ring[127X[104X
    [4X[25X>[125X [27X);;[127X[104X
    [4X[25Xgap>[125X [27X# check that the compiled code is loaded automatically[127X[104X
    [4X[25X>[125X [27X# for this, we use the name of the argument of `ZeroObject`:[127X[104X
    [4X[25X>[125X [27X# for non-compiled code it is "cat", while for compiled code it is "cat_1"[127X[104X
    [4X[25X>[125X [27X[127X[104X
    [4X[25X>[125X [27Xcat := LeftPresentations( QQ );;[127X[104X
    [4X[25Xgap>[125X [27XNamesLocalVariablesFunction( Last( cat!.added_functions.ZeroObject )[1] )[1][127X[104X
    [4X[25X>[125X [27X    = "cat_1";[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27Xcat := LeftPresentations( QQxy );;[127X[104X
    [4X[25Xgap>[125X [27XNamesLocalVariablesFunction( Last( cat!.added_functions.ZeroObject )[1] )[1][127X[104X
    [4X[25X>[125X [27X    = "cat_1";[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27Xcat := LeftPresentations( EEE );;[127X[104X
    [4X[25Xgap>[125X [27XNamesLocalVariablesFunction( Last( cat!.added_functions.ZeroObject )[1] )[1][127X[104X
    [4X[25X>[125X [27X    = "cat_1";[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27Xcat := RightPresentations( QQ );;[127X[104X
    [4X[25Xgap>[125X [27XNamesLocalVariablesFunction( Last( cat!.added_functions.ZeroObject )[1] )[1][127X[104X
    [4X[25X>[125X [27X    = "cat_1";[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27Xcat := RightPresentations( QQxy );;[127X[104X
    [4X[25Xgap>[125X [27XNamesLocalVariablesFunction( Last( cat!.added_functions.ZeroObject )[1] )[1][127X[104X
    [4X[25X>[125X [27X    = "cat_1";[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27Xcat := RightPresentations( EEE );;[127X[104X
    [4X[25Xgap>[125X [27XNamesLocalVariablesFunction( Last( cat!.added_functions.ZeroObject )[1] )[1][127X[104X
    [4X[25X>[125X [27X    = "cat_1";[127X[104X
    [4X[28Xtrue[128X[104X
  [4X[32X[104X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27XLoadPackage( "LinearAlgebraForCAP", false );[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XQQ := HomalgFieldOfRationals( );;[127X[104X
    [4X[25Xgap>[125X [27X# be careful not to use `MatrixCategory` because attributes are not supported[127X[104X
    [4X[25X>[125X [27Xcategory_constructor := function( field )[127X[104X
    [4X[25X>[125X [27X    return Opposite([127X[104X
    [4X[25X>[125X [27X        MATRIX_CATEGORY([127X[104X
    [4X[25X>[125X [27X            field :[127X[104X
    [4X[25X>[125X [27X            no_precompiled_code := false, FinalizeCategory := true[127X[104X
    [4X[25X>[125X [27X        ) :[127X[104X
    [4X[25X>[125X [27X        only_primitive_operations := true[127X[104X
    [4X[25X>[125X [27X    ); end;;[127X[104X
    [4X[25Xgap>[125X [27Xgiven_arguments := [ QQ ];;[127X[104X
    [4X[25Xgap>[125X [27Xcompiled_category_name := "OppositeOfMatrixCategoryPrecompiled";;[127X[104X
    [4X[25Xgap>[125X [27Xpackage_name := "LinearAlgebraForCAP";;[127X[104X
    [4X[25Xgap>[125X [27XCapJitPrecompileCategoryAndCompareResult([127X[104X
    [4X[25X>[125X [27X    category_constructor,[127X[104X
    [4X[25X>[125X [27X    given_arguments,[127X[104X
    [4X[25X>[125X [27X    package_name,[127X[104X
    [4X[25X>[125X [27X    compiled_category_name :[127X[104X
    [4X[25X>[125X [27X    operations := "primitive",[127X[104X
    [4X[25X>[125X [27X    number_of_objectified_objects_in_data_structure_of_object := 2,[127X[104X
    [4X[25X>[125X [27X    number_of_objectified_morphisms_in_data_structure_of_object := 0,[127X[104X
    [4X[25X>[125X [27X    number_of_objectified_objects_in_data_structure_of_morphism := 6,[127X[104X
    [4X[25X>[125X [27X    number_of_objectified_morphisms_in_data_structure_of_morphism := 2[127X[104X
    [4X[25X>[125X [27X);;[127X[104X
    [4X[25Xgap>[125X [27XReadPackage([127X[104X
    [4X[25X>[125X [27X    "LinearAlgebraForCAP",[127X[104X
    [4X[25X>[125X [27X    "gap/precompiled_categories/OppositeOfMatrixCategoryPrecompiled.gi"[127X[104X
    [4X[25X>[125X [27X);;[127X[104X
    [4X[25Xgap>[125X [27XOppositeOfMatrixCategoryPrecompiled( QQ );[127X[104X
    [4X[28XOpposite of Category of matrices over Q[128X[104X
  [4X[32X[104X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27XLoadPackage( "FreydCategoriesForCAP", false );[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XQQ := HomalgFieldOfRationals( );;[127X[104X
    [4X[25Xgap>[125X [27Xvec := CategoryOfRows( QQ : no_precompiled_code );;[127X[104X
    [4X[25Xgap>[125X [27Xfunc := cat -> ZeroObjectFunctorial( cat );;[127X[104X
    [4X[25Xgap>[125X [27XStopCompilationAtCategory( vec );[127X[104X
    [4X[25Xgap>[125X [27XDisplay( CapJitCompiledFunction( func, vec ) );[127X[104X
    [4X[28Xfunction ( cat_1 )[128X[104X
    [4X[28X    return ZeroObjectFunctorial( cat_1 );[128X[104X
    [4X[28Xend[128X[104X
    [4X[25Xgap>[125X [27XContinueCompilationAtCategory( vec );[127X[104X
    [4X[25Xgap>[125X [27XDisplay( CapJitCompiledFunction( func, vec ) );[127X[104X
    [4X[28Xfunction ( cat_1 )[128X[104X
    [4X[28X    local morphism_attr_1_1, deduped_2_1;[128X[104X
    [4X[28X    deduped_2_1 := CreateCapCategoryObjectWithAttributes( cat_1, [128X[104X
    [4X[28X       RankOfObject, 0 );[128X[104X
    [4X[28X    morphism_attr_1_1 := HomalgZeroMatrix( 0, 0, UnderlyingRing( cat_1 ) );[128X[104X
    [4X[28X    return CreateCapCategoryMorphismWithAttributes( cat_1, deduped_2_1, [128X[104X
    [4X[28X       deduped_2_1, UnderlyingMatrix, morphism_attr_1_1 );[128X[104X
    [4X[28Xend[128X[104X
    [4X[25Xgap>[125X [27Xvec := CategoryOfRows( QQ : no_precompiled_code );;[127X[104X
    [4X[25Xgap>[125X [27XStopCompilationAtPrimitivelyInstalledOperationsOfCategory( vec );[127X[104X
    [4X[25Xgap>[125X [27XDisplay( CapJitCompiledFunction( func, vec ) );[127X[104X
    [4X[28Xfunction ( cat_1 )[128X[104X
    [4X[28X    local deduped_1_1;[128X[104X
    [4X[28X    deduped_1_1 := ZeroObject( cat_1 );[128X[104X
    [4X[28X    return ZeroMorphism( cat_1, deduped_1_1, deduped_1_1 );[128X[104X
    [4X[28Xend[128X[104X
    [4X[25Xgap>[125X [27XContinueCompilationAtPrimitivelyInstalledOperationsOfCategory( vec );[127X[104X
    [4X[25Xgap>[125X [27XDisplay( CapJitCompiledFunction( func, vec ) );[127X[104X
    [4X[28Xfunction ( cat_1 )[128X[104X
    [4X[28X    local morphism_attr_1_1, deduped_2_1;[128X[104X
    [4X[28X    deduped_2_1 := CreateCapCategoryObjectWithAttributes( cat_1, [128X[104X
    [4X[28X       RankOfObject, 0 );[128X[104X
    [4X[28X    morphism_attr_1_1 := HomalgZeroMatrix( 0, 0, UnderlyingRing( cat_1 ) );[128X[104X
    [4X[28X    return CreateCapCategoryMorphismWithAttributes( cat_1, deduped_2_1, [128X[104X
    [4X[28X       deduped_2_1, UnderlyingMatrix, morphism_attr_1_1 );[128X[104X
    [4X[28Xend[128X[104X
  [4X[32X[104X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27Xfunc1 := function( x, y )[127X[104X
    [4X[25X>[125X [27X    #% CAP_JIT_RESOLVE_FUNCTION[127X[104X
    [4X[25X>[125X [27X    return x; end;;[127X[104X
    [4X[25Xgap>[125X [27Xfunc2 := function( )[127X[104X
    [4X[25X>[125X [27X  local var; var := 1; var := func1( 2, var ); return var; end;;[127X[104X
    [4X[25Xgap>[125X [27Xcompiled_func := CapJitCompiledFunction( func2 );;[127X[104X
    [4X[25Xgap>[125X [27Xcompiled_func();[127X[104X
    [4X[28X2[128X[104X
  [4X[32X[104X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27Xfunc := function( )[127X[104X
    [4X[25X>[125X [27X  local id; id := y -> y; return [ id, id ]; end;;[127X[104X
    [4X[25Xgap>[125X [27X# we are not interested in the output, but only that this does not throw[127X[104X
    [4X[25X>[125X [27X# an error due to some function id being used multiple times[127X[104X
    [4X[25X>[125X [27XCapJitCompiledFunction( func );;[127X[104X
  [4X[32X[104X
  
